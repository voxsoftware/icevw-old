$(function(){var t,e,r="http://localhost:49672",i={},n=function(t){this.name=t},s=function(){if(!s.hab){var e=function(){t.post("api/call",{method:"??",uid:t.uid},function(){setTimeout(e,15e3)},function(t){console.log("Ocurri√≥ un error al tratar de mantener activo el proceso ICEVW"),console.error(t),setTimeout(e,15e3)}),s.hab=!0};setTimeout(e,15e3)}};e=i.uniqid=function(t,e){"undefined"==typeof t&&(t="");var r,i=function(t,e){return t=parseInt(t,10).toString(16),e<t.length?t.slice(t.length-e):e>t.length?Array(1+(e-t.length)).join("0")+t:t};return this.php_js||(this.php_js={}),this.php_js.uniqidSeed||(this.php_js.uniqidSeed=Math.floor(123456789*Math.random())),this.php_js.uniqidSeed++,r=t,r+=i(parseInt((new Date).getTime()/1e3,10),8),r+=i(this.php_js.uniqidSeed,5),e&&(r+=(10*Math.random()).toFixed(8).toString()),r},t=function(){this.url=r,this.uid=e(),this.iframe=$("<iframe>"),this.iframe.hide(),this.funcs={},this.funcsd={},this.iframe.css("border","none"),$("body").append(this.iframe),this.callbacks={};var t=this;window.addEventListener("message",function(e){if(e.origin==r){var i=JSON.parse(e.data);if("icevw.notauthorized"==i.type){var n=new Error(i.error);return n.type=i.type,t.iframe.hide(),t.callback(n)}if("icevw.adquireerror"==i.type){var n=i.error;return n.message||(n=new Error(n)),n.type=i.type,t.iframe.hide(),t.callback(n)}if("icevw.adquiredandloaded"==i.type)return t.iframe.hide(),s(),t.callback(void 0,i.data)}})},t.prototype.get=function(t,e,r,i,n,s){return this.request("get",t,e,r,i,n,s)},t.prototype.post=function(t,e,r,i,n,s){return this.request("post",t,e,r,i,n,s)},t.prototype.request=function(e,r,i,n,s,o,u){return"http://"!=r.substring(0,7)&&"https://"!=r.substring(0,8)&&"ws://"!=r.substring(0,5)&&(r=t.url+"/"+r),$.ajax({url:r,type:e,data:i,processData:u?!1:!0,error:function(t,e,r){return"abort"==e?void(o&&o()):void(s&&s(new Error(r)))},success:function(t){var e=t?t.error:null;return e?void(s&&s(e)):void(n&&n(t))}})},n.prototype.func=function(){var e=this;return function(){var i=Array.prototype.slice.call(arguments,0,arguments.length-1);i=JSON.stringify(i),console.log(i);var n=arguments[arguments.length-1];t.post(r+"/api/call",{method:e.name,arguments:i,uid:t.uid},function(t){return n(void 0,t)},function(t){return n(t)})}},t.prototype.adquire=function(t,e){var r=this,i=t.url||"";"http://"!=i.substring(0,7)&&"https://"!=i.substring(0,8)&&"ws://"!=i.substring(0,5)&&(i=location.origin+"/"+i);var n=[];n.push("domain="+encodeURIComponent(location.origin)),n.push("&"),n.push("url="+encodeURIComponent(i)),n.push("&"),n.push("uid="+r.uid),n.push("&"),n.push("app="+t.app);var s=r.iframe;s.attr("src",r.url+"/require?"+n.join("")),s.css("width","100%"),s.css("height","100%"),s.css("position","fixed"),s.css("top","0"),s.css("left","0"),s.css("z-index","99999"),s.show(),this.callback=e},t.prototype.func=function(t){var e;if(e=this.funcs[t])return e;var r;return this.funcsd[t]=r=new n(t),this.funcs[t]=e=r.func(),e},window.icevw=t=new t});